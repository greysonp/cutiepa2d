<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../assets/css/yui-cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon.ico">
    <script src="../assets/js/yui-source.js"></script>
	<title>cutiepa2d v0.0.0 API Documentation : src/cutie.js</title>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><a href=""><img src="../../assets/logo.png" title="cutiepa2d"></a></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Documentation for: 0.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AsteroidMovement.html">AsteroidMovement</a></li>
            
                <li><a href="../classes/Behavior.html">Behavior</a></li>
            
                <li><a href="../classes/cutie.html">cutie</a></li>
            
                <li><a href="../classes/DPadMovement.html">DPadMovement</a></li>
            
                <li><a href="../classes/DragAndDrop.html">DragAndDrop</a></li>
            
                <li><a href="../classes/EightDirectionalMovement.html">EightDirectionalMovement</a></li>
            
                <li><a href="../classes/Follow.html">Follow</a></li>
            
                <li><a href="../classes/JoystickMovement.html">JoystickMovement</a></li>
            
                <li><a href="../classes/KeyCodes.html">KeyCodes</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Route.html">Route</a></li>
            
                <li><a href="../classes/ScaleType.html">ScaleType</a></li>
            
                <li><a href="../classes/Scene.html">Scene</a></li>
            
                <li><a href="../classes/Shoot.html">Shoot</a></li>
            
                <li><a href="../classes/Util.html">Util</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Behavior.html">Behavior</a></li>
            
                <li><a href="../modules/cutie.html">cutie</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
            <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <script>
	var name = src/cutie.js      
</script>
<h1 class="file-heading">File:cutie.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
this.cutie = createjs;



/**
 * For documentation on the various methods cutie has, see the class documentation.
 * @module cutie
 * @main cutie
 */
(function(module) {
    /**
     * # Cutiepa2D.js
     * Cutiepa2D (pronounced cutie-patootie) is a wrapper for CreateJS. Its purpose is to make developing 2D games in javascript dead simple. It extends CreateJS with additional functionality and structure while still allowing you to access all of CreateJS&#x27;s existing utilities.
     * We think it&#x27;s quite cute, and we hope you do too.
     * 
     * ## Download
     * Grab it here! **[Download](build/cutiepa2d.js)**
     * 
     * ## Getting Started
     * After downloading cutie, include it in your &#x60;&#x60;&#x60;index.html&#x60;&#x60;&#x60;.
     * 
     *     &lt;script type=&quot;text/javascript&quot; src=&quot;cutiepa2d.js&quot;&gt;&lt;/script&gt;
     * 
     * You&#x27;ll also have to run a local server in order to get image loading to work. I recommend [XAMMP](http://www.apachefriends.org/index.html) to get started.
     * After that, you should be good to go! We have some examples in the [repo](https://github.com/greysonp/cutiepa2d), but we&#x27;ll be writing proper tutorials (as well as expanding functionality) in the coming days.
     * 
     * ## Getting it on Your Phone
     * Testing in the browser is cool, but testing on your phone/tablet is even cooler. Thankfully, there&#x27;s an awesome framework out there called &lt;a href=&quot;https://www.ludei.com/&quot;&gt;CocoonJS&lt;/a&gt; that makes this dead-simple. First, they&#x27;re framework converts your javascript canvas code to fast-performing WebGL code. But one of the coolest parts is that they have an app that you install on your iPhone/Android device that will allow you to literally copy your game files to your phone and play them. You don&#x27;t even need a developer license on iOS! Very cool stuff. For a tutorial on using the app, check out [this page](http://support.ludei.com/hc/en-us/articles/201048463-How-to-use).
     * 
     * ## Brought to You By  
     * * [greysonp](https://github.com/greysonp)
     * * [MaybeNot](https://github.com/MaybeNot)
     * * [stephenrlouie](https://github.com/stephenrlouie)
     * 
     * @class cutie
     * @static
     */

    var _scenes = {};
    var _activeScene = {};
    var _canvas = {};
    var _stage = {};
    var _loaders = {};
    var _hud = {};
    var _fps = { &quot;sum&quot;: 0, &quot;numTicks&quot;: 0, &quot;textView&quot;: {} };
    module.WIDTH = 0;
    module.HEIGHT = 0;

    // ======================================================
    // PUBLIC
    // ======================================================
    /**
     * Starts the game.
     * @method start
     * @public
     * @static
     * @param  {Scene} scene 
     *         The scene to start the game with.
     * @param  {Object} [props={}] A series of properties that affects the overall game and how the scene is set.
     * @param  {String} [props.canvasId=&quot;js-canvas&quot;] The id of the canvas element you want to display your game in.
     * @param  {Scene[]} [props.preloadScenes=[]] Which additional scenes to preload when you load this scene. 
     *                                               The progress bar for this scene will be representative of this 
     *                                               list&#x27;s preload progress.
     * @param  {Object} [props.debugFPS={}] A set of options related to showing the frames per second (FPS) on-screen
     *                                      for debug purposes.
     * @param  {String} [props.debugFPS.size=&quot;20px&quot;] The size of the FPS text. You must include units.
     * @param  {String} [props.debugFPS.color=&quot;#000000&quot;] The color of the FPS text. Any valid CSS color should work.
     * @param  {Number} [props.debugFPS.updateInterval=500] How often the FPS should update. Making the update interval too
     *                                                      short will just make the number unreadable (it&#x27;ll change too fast).
     * @param  {Number} [props.scaleType=cutie.ScaleType.NONE] How you want the canvas to scale in the window. Does not impact the in-game with and height.
     */
    module.start = function(scene, props) {
        cutie.Log.v(&quot;cutie.start()&quot;);

        props = props || {};

        _canvas = document.getElementById(props.canvasId || &quot;js-canvas&quot;);
        module.WIDTH = _canvas.width;
        module.HEIGHT = _canvas.height;
        _stage = new createjs.Stage(_canvas);
        createjs.Touch.enable(_stage);
        createjs.Ticker.timingMode = createjs.Ticker.RAF_SYNCHED;
        _hud = new createjs.Container();
        if (props.scaleType != 0) initScaleCanvas(props.scaleType);

        // Fill in stuff using the properties the user gave
        createjs.Ticker.setFPS(props.fps || 60);
        showFPS(props.debugFPS);

        // Add the listener
        createjs.Ticker.addEventListener(&quot;tick&quot;, tick);

        // Set the scene
        this.setScene(scene, props);

        _stage.addChild(_hud);
    }

    /**
     * Takes the specified scene and sets it as the active scene. This will
     * now be the scene that receives calls to its tick() function. If it is 
     * not already preloaded, it will be preloaded
     * @method setScene
     * @public
     * @static
     * @param {Scene} scene 
     *        The scene to be made active.
     * @param {Object} props 
     *        A series of properties that affects how the scene is set.
     *        &quot;preloadScenes&quot;: Which additional scenes to preload when you 
     *                         load this scene. The progress bar for this 
     *                         scene will be representative of this list&#x27;s
     *                         preload progress.
     */
    module.setScene = function(sceneName, props) {
        cutie.Log.v(&quot;cutie.setScene()&quot;);

        props = props || {};

        // Remove the previously active scene
        _stage.removeChild(_activeScene);

        // Set it as the active scene
        _activeScene = getScene(sceneName);
        if (_activeScene) {
            // Build the list of scenes to preload and then preload them
            var preloadList = props.preloadScenes || [];
            preloadList.unshift(sceneName);
            preloadList = getScenes(preloadList);
            preloadScenes(preloadList);


            // Add it to the stage
            _stage.addChild(_activeScene);
        }
        else {
            cutie.Log.e(&quot;The active scene has been set to null or undefined. This most likely happens when you supply the name of a scene that doesn&#x27;t exist.&quot;);
        }
    }

    /**
     * Adds the scene to the list of registered scenes.
     * @method registerScene
     * @public
     * @static
     * @param  {Scene} scene The scene you want to register.
     * @param  {String} name The name you want to associate with the scene. This is the
     *                       name you will use when setting and preloading scenes.
     */
    module.registerScene = function(scene, name) {
        if (_scenes[name]) {
            cutie.Log.w(&quot;You registered a scene called &#x27;&quot; + name + &quot;&#x27;, but there was already a scene registered with that name. It was overwritten.&quot;);
        }
        _scenes[name] = scene;
        scene.name = name;
    }

    /**
     * Gets a references to the stage being managed by cutie.
     * @method getStage
     * @public
     * @static
     * @return {createjs.Stage} A reference to the stage being managed by cutie.
     */
    module.getStage = function() {
        return _stage;
    }

    /**
     * Gets a references to the active scene being managed by cutie.
     * @method getActiveScene
     * @public
     * @static
     * @return {Scene} A reference to the active scene being managed by cutie.
     */
    module.getActiveScene = function() {
        return _activeScene;
    }

    module.storeLoader = function(sceneName, loader) {
        _loaders[sceneName] = loader;
    }

    // ======================================================
    // PRIVATE
    // ======================================================
    /**
     * Description:
     *      Calls the internel Ticks on all scene objects
     *      @private
     *
     *      @param  {createjs.Event} e description
     */
    function tick(e) {
        _activeScene._tickInternal(e);
        _stage.update();

        _fps.sum += e.delta;
        _fps.numTicks++;
    }

    /**
     * Preloads a list of scenes, and adds the preload event listeners
     * to the first scene in the list
     * @private
     * @param  {Scene} scenes 
     *         List of scenes to be preloaded.
     */
    function preloadScenes(scenes) {
        var loader = new createjs.LoadQueue();
        loader.installPlugin(createjs.Sound);

        // Have all of the scene add onto the the same LoadQueue
        var needsPreload = false;
        for (var i = 0; i &lt; scenes.length; i++) {
            // If we don&#x27;t have a stored loader for this scene
            if (!_loaders[scenes[i].name]) {
                // Create a new LoadQueue and give it to the scene to preload and store the loader
                scenes[i].preload(loader);
                needsPreload = true;
            }
        }
        // If we need to preload, attach the appropriate events to the first scene in the list (which is our main scene - 
        // the rest are just being loaded ahead of time).
        if (needsPreload) {
            loader.on(&quot;complete&quot;, scenes[0].onPreloadComplete.bind(scenes[0], scenes, loader), scenes[0]);
            loader.on(&quot;progress&quot;, scenes[0].onPreloadProgress, scenes[0]);

            // Kick-off the loading (just in case any files were added to the queue and set to not immmediately load)
            loader.load();
        }
        // If you don&#x27;t need to preload anything, just kick off the init
        else {
            scenes[0]._init(_loaders[scenes[0].name]);
        }
    }

    /**
     * Description
     * @private
     * @param  {String[]} sceneNames description
     * @return {Scene[]}       description
     */
    function getScenes(sceneNames) {
        var scenes = [];
        for (var i = 0; i &lt; sceneNames.length; i++) {
            scenes.push(getScene(sceneNames[i]));
        }
        return scenes;
    }

    /**
     * Description
     * @private
     * @param  {String} sceneNames  description
     * @return {Scene}        description
     */
    function getScene(sceneName) {
        var scene = _scenes[sceneName];
        if (!scene) {
            cutie.Log.e(&quot;The scene &#x27;&quot; + sceneName + &quot;&#x27; does not exist.&quot;);
            return null;
        }
        return scene;
    }

    /**
     *      @private
     *
     *      @param  {Object} props description
     */
    function showFPS(props) {
        if (props &amp;&amp; props.visible) {
            var size = props.size || &quot;20px&quot;;
            var color = props.color || &quot;#000000&quot;;
            var updateInterval = props.updateInterval || 500;

            _fps.textView = new createjs.Text(&quot;&quot;, size + &quot; Arial&quot;, color);
            _hud.addChild(_fps.textView);
            setInterval(updateFPS, updateInterval);
        }
    }

    /**
     *      @private
     *
     */
    function updateFPS() {
        var avg = _fps.sum/_fps.numTicks;
        var fps = 1000/avg;
        fps = Math.round(fps * 10) / 10;
        _fps.textView.text = fps + &quot; fps&quot;;

        _fps.sum = _fps.numTicks = 0;
    }

    function initScaleCanvas(scaleType) {
        window.onresize = scaleCanvas.bind(this, scaleType);
        scaleCanvas(scaleType);
    }

    function scaleCanvas(scaleType, e) {
        var body = document.getElementsByTagName(&quot;body&quot;)[0];

        if (scaleType == cutie.ScaleType.STRETCH || scaleType === cutie.ScaleType.LETTERBOX) {
            body.style.padding = &quot;0&quot;;
            body.style.margin = &quot;0&quot;;
        }

        if (scaleType == cutie.ScaleType.STRETCH) {
            _canvas.style.width = &quot;100%&quot;;
            _canvas.style.height = &quot;100%&quot;;
        }
        else if (scaleType == cutie.ScaleType.LETTERBOX) {
            // Give us a black background for the letterbox
            body.style.background = &quot;#000000&quot;;

            // Calculate the percentage difference between canvas width and window width
            var diff = cutie.WIDTH / window.innerWidth;

            // Scale by height
            if ((cutie.HEIGHT / diff) &gt; window.innerHeight) {
                var newWidth = cutie.WIDTH * window.innerHeight/cutie.HEIGHT;
                _canvas.style.width = newWidth;
                _canvas.style.height = &quot;100%&quot;;
                _canvas.style.marginLeft = (window.innerWidth - newWidth)/2;
                _canvas.style.marginTop = 0;
            }
            // Scale by width
            else {
                var newHeight = cutie.HEIGHT * window.innerWidth/cutie.WIDTH;
                _canvas.style.width = &quot;100%&quot;;
                _canvas.style.height = newHeight;
                _canvas.style.marginTop = (window.innerHeight - newHeight)/2;
                _canvas.style.marginLeft = 0;
            }
        }
    }

})(this.cutie);

/**
 * Fixed touch events for CacoonJS.
 */
(function(){
  /**
   * Protected Function updatePointerPosition
   *    @method _updatePointerPosition
   *    @protected
   *
   *    @param {Number} id
   *    @param {Number} pageX
   *    @param {Number} pageY
   **/
  createjs.Stage.prototype._updatePointerPosition = function(id, e, pageX, pageY) {
    var rect = this._getElementRect(this.canvas);
    var w = this.canvas.width;
    var h = this.canvas.height;

    // CocoonJS Touchfix
    if( isNaN(rect.left)   ) rect.left = 0;
    if( isNaN(rect.top)    ) rect.top = 0;
    if( isNaN(rect.right)  ) rect.right = w;
    if( isNaN(rect.bottom) ) rect.bottom = h;
    // \CocoonJS Touchfix end

    pageX -= rect.left;
    pageY -= rect.top;

    pageX /= (rect.right-rect.left)/w;
    pageY /= (rect.bottom-rect.top)/h;
    var o = this._getPointerData(id);
    if (o.inBounds = (pageX &gt;= 0 &amp;&amp; pageY &gt;= 0 &amp;&amp; pageX &lt;= w-1 &amp;&amp; pageY &lt;= h-1)) {
      o.x = pageX;
      o.y = pageY;
    } else if (this.mouseMoveOutside) {
      o.x = pageX &lt; 0 ? 0 : (pageX &gt; w-1 ? w-1 : pageX);
      o.y = pageY &lt; 0 ? 0 : (pageY &gt; h-1 ? h-1 : pageY);
    }

    o.rawX = pageX;
    o.rawY = pageY;

    if (id == this._primaryPointerID) {
      this.mouseX = o.x;
      this.mouseY = o.y;
      this.mouseInBounds = o.inBounds;
    }
  }

})();

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
